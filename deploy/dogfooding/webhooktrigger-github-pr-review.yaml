apiVersion: kubetask.io/v1alpha1
kind: WebhookTrigger
metadata:
  name: github-pr-review-only
spec:
  auth:
    hmac:
      secretRef:
        name: github-webhook-secret
        key: hmacKey
      signatureHeader: X-Hub-Signature-256
      algorithm: sha256
  filter: |
    // Auto review all PRs when opened
    headers["x-github-event"] == "pull_request" &&
    body.action == "opened"
  taskTemplate:
    agentRef: default
    description: |
      请 review 这个 PR:

      Repo: {{ .repository.full_name }}
      Author: {{ .sender.login }}

      PR #{{ .pull_request.number }}: {{ .pull_request.title }}
      PR URL: {{ .pull_request.html_url }}
      PR Body: {{ .pull_request.body }}

---
