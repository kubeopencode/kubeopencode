# Copyright Contributors to the KubeTask project
# Agent configuration for AI agent with credentials
apiVersion: kubetask.io/v1alpha1
kind: Agent
metadata:
  name: dev
spec:
  agentImage: quay.io/kubetask/kubetask-agent-gemini:latest
  workspaceDir: /workspace
  command:
    - sh
    - -c
    - gemini --output-format stream-json --yolo -p "$(cat ${WORKSPACE_DIR}/task.md)"
  serviceAccountName: kubetask-agent
  maxConcurrentTasks: 3
  credentials:
    # Mount entire secret - all keys become env vars automatically
    - name: github
      secretRef:
        name: github-credentials
    - name: gemini
      secretRef:
        name: gemini-credentials
  # Agent-level contexts (lowest priority, applied to all tasks)
  contexts:
    - ref:
        name: basic-rules
